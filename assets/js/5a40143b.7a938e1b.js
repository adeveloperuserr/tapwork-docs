"use strict";(self.webpackChunktapwork_docs=self.webpackChunktapwork_docs||[]).push([[817],{3539:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"architecture/api-architecture","title":"API Architecture","description":"This document describes the structure of the TAPWORK REST API, including endpoints, request/response formats, and architectural patterns.","source":"@site/docs/architecture/api-architecture.md","sourceDirName":"architecture","slug":"/architecture/api-architecture","permalink":"/tapwork-docs/architecture/api-architecture","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Data Architecture","permalink":"/tapwork-docs/architecture/data-architecture"},"next":{"title":"Process Flows","permalink":"/tapwork-docs/architecture/process-flows"}}');var t=r(4848),s=r(8453);const a={},d="API Architecture",l={},o=[{value:"API Overview",id:"api-overview",level:2},{value:"Key Features",id:"key-features",level:3},{value:"API Layers",id:"api-layers",level:2},{value:"1. Routes Layer",id:"1-routes-layer",level:3},{value:"2. Controllers Layer",id:"2-controllers-layer",level:3},{value:"3. Services Layer",id:"3-services-layer",level:3},{value:"4. Repository Layer",id:"4-repository-layer",level:3},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Authentication Endpoints",id:"authentication-endpoints",level:3},{value:"Register User",id:"register-user",level:4},{value:"Login",id:"login",level:4},{value:"Refresh Token",id:"refresh-token",level:4},{value:"User Management Endpoints",id:"user-management-endpoints",level:3},{value:"Get Current User",id:"get-current-user",level:4},{value:"List Users (Admin Only)",id:"list-users-admin-only",level:4},{value:"Update User (Admin Only)",id:"update-user-admin-only",level:4},{value:"Delete User (Admin Only)",id:"delete-user-admin-only",level:4},{value:"Attendance Endpoints",id:"attendance-endpoints",level:3},{value:"Record Attendance (Check-in/Check-out)",id:"record-attendance-check-incheck-out",level:4},{value:"Get User Attendance History",id:"get-user-attendance-history",level:4},{value:"Get All Attendance (Admin Only)",id:"get-all-attendance-admin-only",level:4},{value:"QR Code Endpoints",id:"qr-code-endpoints",level:3},{value:"Get User QR Code",id:"get-user-qr-code",level:4},{value:"Regenerate QR Code",id:"regenerate-qr-code",level:4},{value:"Department Endpoints",id:"department-endpoints",level:3},{value:"List Departments",id:"list-departments",level:4},{value:"Create Department (Admin Only)",id:"create-department-admin-only",level:4},{value:"Shift Endpoints",id:"shift-endpoints",level:3},{value:"List Shifts",id:"list-shifts",level:4},{value:"Create Shift (Admin Only)",id:"create-shift-admin-only",level:4},{value:"Reports Endpoints",id:"reports-endpoints",level:3},{value:"Generate Attendance Report",id:"generate-attendance-report",level:4},{value:"Get Department Summary",id:"get-department-summary",level:4},{value:"Biometric Endpoints (Optional)",id:"biometric-endpoints-optional",level:3},{value:"Enroll Biometric",id:"enroll-biometric",level:4},{value:"Verify Biometric",id:"verify-biometric",level:4},{value:"Request/Response Flow",id:"requestresponse-flow",level:2},{value:"Authentication &amp; Authorization",id:"authentication--authorization",level:2},{value:"JWT Token Structure",id:"jwt-token-structure",level:3},{value:"Role Permissions",id:"role-permissions",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Standard Error Response",id:"standard-error-response",level:3},{value:"HTTP Status Codes",id:"http-status-codes",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Default Limits",id:"default-limits",level:3},{value:"Rate Limit Headers",id:"rate-limit-headers",level:3},{value:"API Versioning",id:"api-versioning",level:2},{value:"Version Support",id:"version-support",level:3},{value:"API Documentation",id:"api-documentation",level:2},{value:"Interactive Documentation",id:"interactive-documentation",level:3},{value:"Testing",id:"testing",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"api-architecture",children:"API Architecture"})}),"\n",(0,t.jsx)(n.p,{children:"This document describes the structure of the TAPWORK REST API, including endpoints, request/response formats, and architectural patterns."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"api-overview",children:"API Overview"}),"\n",(0,t.jsxs)(n.p,{children:["The TAPWORK API is built with ",(0,t.jsx)(n.strong,{children:"FastAPI"}),", providing a modern, fast, and highly performant REST API with automatic OpenAPI documentation."]}),"\n",(0,t.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"RESTful Design"}),": Resource-based URLs with standard HTTP methods"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automatic Documentation"}),": Swagger UI and ReDoc available at ",(0,t.jsx)(n.code,{children:"/docs"})," and ",(0,t.jsx)(n.code,{children:"/redoc"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type Safety"}),": Pydantic models for request/response validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authentication"}),": JWT-based token authentication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authorization"}),": Role-based access control (RBAC)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Validation"}),": Automatic request validation and error handling"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"api-layers",children:"API Layers"}),"\n",(0,t.jsx)(n.p,{children:"The API follows a layered architecture pattern for separation of concerns:"}),"\n",(0,t.jsx)(n.mermaid,{value:"flowchart TB\r\n    %% Styling for dark/light mode\r\n    classDef layerStyle fill:#7b1fa2,stroke:#4a148c,stroke-width:3px,color:#fff\r\n    classDef dbStyle fill:#388e3c,stroke:#1b5e20,stroke-width:3px,color:#fff\r\n\r\n    Client[Client Request]\r\n    Router[Routes Layer<br/>FastAPI Routers]\r\n    Controller[Controllers Layer<br/>Request/Response Handling]\r\n    Service[Services Layer<br/>Business Logic]\r\n    Repository[Repository Layer<br/>Data Access]\r\n    DB[(Database)]\r\n\r\n    Client --\x3e|HTTP Request| Router\r\n    Router --\x3e|Route to| Controller\r\n    Controller --\x3e|Call| Service\r\n    Service --\x3e|Query| Repository\r\n    Repository --\x3e|SQL| DB\r\n    DB --\x3e|Data| Repository\r\n    Repository --\x3e|Models| Service\r\n    Service --\x3e|Response| Controller\r\n    Controller --\x3e|HTTP Response| Client\r\n\r\n    class Router,Controller,Service,Repository layerStyle\r\n    class DB dbStyle"}),"\n",(0,t.jsx)(n.h3,{id:"1-routes-layer",children:"1. Routes Layer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Defines API endpoints and URL patterns"}),"\n",(0,t.jsx)(n.li,{children:"Maps HTTP methods to controller functions"}),"\n",(0,t.jsx)(n.li,{children:"Groups related endpoints into routers"}),"\n",(0,t.jsx)(n.li,{children:"Applies middleware and dependencies"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-controllers-layer",children:"2. Controllers Layer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Handles HTTP request/response logic"}),"\n",(0,t.jsx)(n.li,{children:"Validates request data using Pydantic models"}),"\n",(0,t.jsx)(n.li,{children:"Extracts authentication tokens"}),"\n",(0,t.jsx)(n.li,{children:"Formats responses"}),"\n",(0,t.jsx)(n.li,{children:"Handles exceptions"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"3-services-layer",children:"3. Services Layer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Contains business logic"}),"\n",(0,t.jsx)(n.li,{children:"Orchestrates multiple repository calls"}),"\n",(0,t.jsx)(n.li,{children:"Implements validation rules"}),"\n",(0,t.jsx)(n.li,{children:"Handles complex workflows"}),"\n",(0,t.jsx)(n.li,{children:"Manages transactions"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"4-repository-layer",children:"4. Repository Layer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Direct database interaction"}),"\n",(0,t.jsx)(n.li,{children:"CRUD operations"}),"\n",(0,t.jsx)(n.li,{children:"Query construction"}),"\n",(0,t.jsx)(n.li,{children:"Database transactions"}),"\n",(0,t.jsx)(n.li,{children:"ORM model mapping"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,t.jsx)(n.h3,{id:"authentication-endpoints",children:"Authentication Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"register-user",children:"Register User"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/auth/register\r\nContent-Type: application/json\r\n\r\n{\r\n  "email": "employee@company.com",\r\n  "password": "SecurePass123!",\r\n  "first_name": "John",\r\n  "last_name": "Doe",\r\n  "employee_id": "EMP001",\r\n  "department_id": "uuid",\r\n  "shift_id": "uuid"\r\n}\r\n\r\nResponse: 201 Created\r\n{\r\n  "id": "uuid",\r\n  "email": "employee@company.com",\r\n  "employee_id": "EMP001",\r\n  "qr_code": "base64_encoded_qr_image",\r\n  "message": "Registration successful. QR code sent to email."\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"login",children:"Login"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/auth/login\r\nContent-Type: application/json\r\n\r\n{\r\n  "email": "employee@company.com",\r\n  "password": "SecurePass123!"\r\n}\r\n\r\nResponse: 200 OK\r\n{\r\n  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",\r\n  "token_type": "bearer",\r\n  "expires_in": 3600,\r\n  "user": {\r\n    "id": "uuid",\r\n    "email": "employee@company.com",\r\n    "role": "employee"\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"refresh-token",children:"Refresh Token"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/auth/refresh\r\nAuthorization: Bearer {refresh_token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "access_token": "new_jwt_token",\r\n  "token_type": "bearer",\r\n  "expires_in": 3600\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"user-management-endpoints",children:"User Management Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"get-current-user",children:"Get Current User"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/users/me\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "id": "uuid",\r\n  "email": "employee@company.com",\r\n  "first_name": "John",\r\n  "last_name": "Doe",\r\n  "employee_id": "EMP001",\r\n  "department": "Engineering",\r\n  "shift": "Morning Shift",\r\n  "role": "employee",\r\n  "is_active": true\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"list-users-admin-only",children:"List Users (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/users?page=1&limit=20&department_id=uuid&is_active=true\r\nAuthorization: Bearer {admin_token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "total": 150,\r\n  "page": 1,\r\n  "limit": 20,\r\n  "users": [\r\n    {\r\n      "id": "uuid",\r\n      "email": "employee@company.com",\r\n      "full_name": "John Doe",\r\n      "employee_id": "EMP001",\r\n      "department": "Engineering",\r\n      "is_active": true\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"update-user-admin-only",children:"Update User (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'PUT /api/v1/users/{user_id}\r\nAuthorization: Bearer {admin_token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "first_name": "John",\r\n  "last_name": "Smith",\r\n  "department_id": "new_uuid",\r\n  "shift_id": "new_uuid",\r\n  "is_active": true\r\n}\r\n\r\nResponse: 200 OK\r\n{\r\n  "id": "uuid",\r\n  "message": "User updated successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"delete-user-admin-only",children:"Delete User (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"DELETE /api/v1/users/{user_id}\r\nAuthorization: Bearer {admin_token}\r\n\r\nResponse: 204 No Content\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"attendance-endpoints",children:"Attendance Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"record-attendance-check-incheck-out",children:"Record Attendance (Check-in/Check-out)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/attendance\r\nAuthorization: Bearer {token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "qr_code": "scanned_qr_data",\r\n  "location": "Main Office",\r\n  "biometric_data": "optional_biometric_hash"\r\n}\r\n\r\nResponse: 201 Created\r\n{\r\n  "id": "uuid",\r\n  "user_id": "uuid",\r\n  "action": "check_in",\r\n  "timestamp": "2024-01-15T08:30:00Z",\r\n  "status": "on_time",\r\n  "message": "Check-in recorded successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"get-user-attendance-history",children:"Get User Attendance History"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/attendance/me?start_date=2024-01-01&end_date=2024-01-31\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "total": 20,\r\n  "records": [\r\n    {\r\n      "id": "uuid",\r\n      "check_in": "2024-01-15T08:30:00Z",\r\n      "check_out": "2024-01-15T17:30:00Z",\r\n      "status": "on_time",\r\n      "hours_worked": 9.0,\r\n      "location": "Main Office"\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"get-all-attendance-admin-only",children:"Get All Attendance (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/attendance?user_id=uuid&date=2024-01-15&status=late\r\nAuthorization: Bearer {admin_token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "total": 5,\r\n  "records": [\r\n    {\r\n      "id": "uuid",\r\n      "user": "John Doe",\r\n      "employee_id": "EMP001",\r\n      "check_in": "2024-01-15T08:35:00Z",\r\n      "status": "late",\r\n      "minutes_late": 5\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"qr-code-endpoints",children:"QR Code Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"get-user-qr-code",children:"Get User QR Code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/qr/me\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "qr_code": "base64_encoded_image",\r\n  "code_data": "encrypted_qr_string",\r\n  "generated_at": "2024-01-15T08:00:00Z",\r\n  "expires_at": null\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"regenerate-qr-code",children:"Regenerate QR Code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/qr/regenerate\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "qr_code": "base64_encoded_new_image",\r\n  "message": "QR code regenerated successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"department-endpoints",children:"Department Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"list-departments",children:"List Departments"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/departments\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "departments": [\r\n    {\r\n      "id": "uuid",\r\n      "name": "Engineering",\r\n      "employee_count": 25,\r\n      "manager": "Jane Smith"\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"create-department-admin-only",children:"Create Department (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/departments\r\nAuthorization: Bearer {admin_token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "name": "Marketing",\r\n  "description": "Marketing and Communications",\r\n  "manager_id": "uuid"\r\n}\r\n\r\nResponse: 201 Created\r\n{\r\n  "id": "uuid",\r\n  "name": "Marketing",\r\n  "message": "Department created successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"shift-endpoints",children:"Shift Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"list-shifts",children:"List Shifts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/shifts\r\nAuthorization: Bearer {token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "shifts": [\r\n    {\r\n      "id": "uuid",\r\n      "name": "Morning Shift",\r\n      "start_time": "08:00:00",\r\n      "end_time": "17:00:00",\r\n      "grace_period_minutes": 15,\r\n      "working_days": [1, 2, 3, 4, 5]\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"create-shift-admin-only",children:"Create Shift (Admin Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/shifts\r\nAuthorization: Bearer {admin_token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "name": "Night Shift",\r\n  "start_time": "22:00:00",\r\n  "end_time": "06:00:00",\r\n  "grace_period_minutes": 10,\r\n  "working_days": [1, 2, 3, 4, 5]\r\n}\r\n\r\nResponse: 201 Created\r\n{\r\n  "id": "uuid",\r\n  "message": "Shift created successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"reports-endpoints",children:"Reports Endpoints"}),"\n",(0,t.jsx)(n.h4,{id:"generate-attendance-report",children:"Generate Attendance Report"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /api/v1/reports/attendance?start_date=2024-01-01&end_date=2024-01-31&department_id=uuid&format=pdf\r\nAuthorization: Bearer {admin_token}\r\n\r\nResponse: 200 OK\r\nContent-Type: application/pdf\r\n[Binary PDF data]\n"})}),"\n",(0,t.jsx)(n.h4,{id:"get-department-summary",children:"Get Department Summary"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'GET /api/v1/reports/department-summary?date=2024-01-15\r\nAuthorization: Bearer {admin_token}\r\n\r\nResponse: 200 OK\r\n{\r\n  "date": "2024-01-15",\r\n  "departments": [\r\n    {\r\n      "name": "Engineering",\r\n      "total_employees": 25,\r\n      "present": 23,\r\n      "late": 2,\r\n      "absent": 0,\r\n      "attendance_rate": 92.0\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"biometric-endpoints-optional",children:"Biometric Endpoints (Optional)"}),"\n",(0,t.jsx)(n.h4,{id:"enroll-biometric",children:"Enroll Biometric"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/biometric/enroll\r\nAuthorization: Bearer {token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "biometric_type": "face",\r\n  "biometric_data": "base64_encoded_template"\r\n}\r\n\r\nResponse: 201 Created\r\n{\r\n  "id": "uuid",\r\n  "message": "Biometric enrolled successfully"\r\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"verify-biometric",children:"Verify Biometric"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'POST /api/v1/biometric/verify\r\nAuthorization: Bearer {token}\r\nContent-Type: application/json\r\n\r\n{\r\n  "biometric_type": "face",\r\n  "biometric_data": "base64_encoded_sample"\r\n}\r\n\r\nResponse: 200 OK\r\n{\r\n  "verified": true,\r\n  "confidence": 0.98,\r\n  "message": "Identity verified"\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"requestresponse-flow",children:"Request/Response Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\r\n    participant C as Client\r\n    participant R as Router\r\n    participant A as Auth Middleware\r\n    participant Ctrl as Controller\r\n    participant S as Service\r\n    participant Repo as Repository\r\n    participant DB as Database\r\n\r\n    C->>R: POST /api/v1/attendance\r\n    R->>A: Validate Token\r\n    A->>A: Decode JWT\r\n    A->>Ctrl: Pass User Context\r\n    Ctrl->>Ctrl: Validate Request Body\r\n    Ctrl->>S: Call Business Logic\r\n    S->>S: Apply Attendance Rules\r\n    S->>Repo: Save Attendance\r\n    Repo->>DB: INSERT INTO attendance_records\r\n    DB--\x3e>Repo: Record Saved\r\n    Repo--\x3e>S: Return Model\r\n    S->>S: Send Notification (async)\r\n    S--\x3e>Ctrl: Return Response Data\r\n    Ctrl--\x3e>R: Format Response\r\n    R--\x3e>C: 201 Created"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"authentication--authorization",children:"Authentication & Authorization"}),"\n",(0,t.jsx)(n.h3,{id:"jwt-token-structure",children:"JWT Token Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\r\n  "sub": "user_uuid",\r\n  "email": "employee@company.com",\r\n  "role": "employee",\r\n  "exp": 1705334400,\r\n  "iat": 1705330800\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"role-permissions",children:"Role Permissions"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Endpoint"}),(0,t.jsx)(n.th,{children:"Employee"}),(0,t.jsx)(n.th,{children:"Supervisor"}),(0,t.jsx)(n.th,{children:"HR Manager"}),(0,t.jsx)(n.th,{children:"Admin"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"POST /attendance"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET /attendance/me"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET /attendance (all)"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705 (team)"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET /users"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"POST /users"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"DELETE /users"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GET /reports"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705 (team)"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"standard-error-response",children:"Standard Error Response"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\r\n  "error": {\r\n    "code": "INVALID_QR_CODE",\r\n    "message": "The provided QR code is invalid or expired",\r\n    "details": {\r\n      "field": "qr_code",\r\n      "reason": "expired"\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"http-status-codes",children:"HTTP Status Codes"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"200 OK"}),": Successful request"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"201 Created"}),": Resource created successfully"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"204 No Content"}),": Successful deletion"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"400 Bad Request"}),": Invalid request data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"401 Unauthorized"}),": Missing or invalid authentication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"403 Forbidden"}),": Insufficient permissions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"404 Not Found"}),": Resource not found"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"409 Conflict"}),": Resource conflict (e.g., duplicate email)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"422 Unprocessable Entity"}),": Validation error"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"500 Internal Server Error"}),": Server error"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,t.jsx)(n.h3,{id:"default-limits",children:"Default Limits"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authentication endpoints"}),": 5 requests per minute"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Attendance recording"}),": 10 requests per minute"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"General endpoints"}),": 100 requests per minute"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Report generation"}),": 10 requests per hour"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"rate-limit-headers",children:"Rate Limit Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"X-RateLimit-Limit: 100\r\nX-RateLimit-Remaining: 95\r\nX-RateLimit-Reset: 1705330800\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"api-versioning",children:"API Versioning"}),"\n",(0,t.jsxs)(n.p,{children:["The API uses URL versioning (",(0,t.jsx)(n.code,{children:"/api/v1/"}),") to maintain backward compatibility. When breaking changes are introduced, a new version will be created (e.g., ",(0,t.jsx)(n.code,{children:"/api/v2/"}),")."]}),"\n",(0,t.jsx)(n.h3,{id:"version-support",children:"Version Support"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Current version: ",(0,t.jsx)(n.code,{children:"v1"})]}),"\n",(0,t.jsxs)(n.li,{children:["Minimum supported version: ",(0,t.jsx)(n.code,{children:"v1"})]}),"\n",(0,t.jsx)(n.li,{children:"Deprecation policy: 6 months notice before version retirement"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"api-documentation",children:"API Documentation"}),"\n",(0,t.jsx)(n.h3,{id:"interactive-documentation",children:"Interactive Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Swagger UI"}),": Available at ",(0,t.jsx)(n.code,{children:"/docs"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ReDoc"}),": Available at ",(0,t.jsx)(n.code,{children:"/redoc"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OpenAPI Spec"}),": Available at ",(0,t.jsx)(n.code,{children:"/openapi.json"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Postman Collection"}),": Available in repository"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Integration Tests"}),": Automated test suite covering all endpoints"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Load Testing"}),": Performance benchmarks using Locust"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.admonition,{title:"Development",type:"tip",children:(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"/docs"})," endpoint to explore and test the API interactively. All endpoints are documented with request/response schemas and examples."]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>d});var i=r(6540);const t={},s=i.createContext(t);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);