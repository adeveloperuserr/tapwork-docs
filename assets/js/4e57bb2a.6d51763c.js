"use strict";(self.webpackChunktapwork_docs=self.webpackChunktapwork_docs||[]).push([[9425],{787:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"architecture/deployment","title":"Deployment Architecture","description":"This document describes how TAPWORK is deployed across different environments, from local development to production Kubernetes clusters.","source":"@site/docs/architecture/deployment.md","sourceDirName":"architecture","slug":"/architecture/deployment","permalink":"/tapwork-docs/architecture/deployment","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Process Flows","permalink":"/tapwork-docs/architecture/process-flows"},"next":{"title":"Contributing","permalink":"/tapwork-docs/CONTRIBUTING"}}');var t=n(4848),a=n(8453);const o={},l="Deployment Architecture",i={},c=[{value:"Deployment Overview",id:"deployment-overview",level:2},{value:"Docker Compose Deployment",id:"docker-compose-deployment",level:2},{value:"Architecture Diagram",id:"architecture-diagram",level:3},{value:"Docker Compose Configuration",id:"docker-compose-configuration",level:3},{value:"Container Details",id:"container-details",level:3},{value:"API Container",id:"api-container",level:4},{value:"PostgreSQL Container",id:"postgresql-container",level:4},{value:"Mailhog Container",id:"mailhog-container",level:4},{value:"Scanner Container",id:"scanner-container",level:4},{value:"Local Development Setup",id:"local-development-setup",level:3},{value:"Kubernetes Deployment",id:"kubernetes-deployment",level:2},{value:"Architecture Diagram",id:"architecture-diagram-1",level:3},{value:"Kubernetes Resources",id:"kubernetes-resources",level:3},{value:"Namespace",id:"namespace",level:4},{value:"ConfigMap",id:"configmap",level:4},{value:"Secrets",id:"secrets",level:4},{value:"API Deployment",id:"api-deployment",level:4},{value:"PostgreSQL StatefulSet",id:"postgresql-statefulset",level:4},{value:"Service Definitions",id:"service-definitions",level:4},{value:"Ingress",id:"ingress",level:4},{value:"HorizontalPodAutoscaler",id:"horizontalpodautoscaler",level:4},{value:"Deployment Workflow",id:"deployment-workflow",level:2},{value:"Production Deployment Process",id:"production-deployment-process",level:3},{value:"Deployment Steps",id:"deployment-steps",level:3},{value:"Environment Configuration",id:"environment-configuration",level:2},{value:"Development",id:"development",level:3},{value:"Staging",id:"staging",level:3},{value:"Production",id:"production",level:3},{value:"Monitoring and Logging",id:"monitoring-and-logging",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Logging Stack",id:"logging-stack",level:3},{value:"Alerts",id:"alerts",level:3},{value:"Backup Strategy",id:"backup-strategy",level:2},{value:"Database Backups",id:"database-backups",level:3},{value:"Configuration Backups",id:"configuration-backups",level:3}];function d(e){const r={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"deployment-architecture",children:"Deployment Architecture"})}),"\n",(0,t.jsx)(r.p,{children:"This document describes how TAPWORK is deployed across different environments, from local development to production Kubernetes clusters."}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"deployment-overview",children:"Deployment Overview"}),"\n",(0,t.jsx)(r.p,{children:"TAPWORK supports multiple deployment strategies to accommodate different scales and requirements:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Local Development"}),": Docker Compose for single-machine setup"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Staging/Testing"}),": Docker Compose on virtual machines"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Production"}),": Kubernetes cluster with high availability"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Cloud-Native"}),": Managed Kubernetes services (EKS, GKE, AKS)"]}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"docker-compose-deployment",children:"Docker Compose Deployment"}),"\n",(0,t.jsx)(r.h3,{id:"architecture-diagram",children:"Architecture Diagram"}),"\n",(0,t.jsx)(r.mermaid,{value:'flowchart TB\r\n    %% Styling for dark/light mode\r\n    classDef containerStyle fill:#0288d1,stroke:#01579b,stroke-width:3px,color:#fff\r\n    classDef volumeStyle fill:#388e3c,stroke:#1b5e20,stroke-width:3px,color:#fff\r\n    classDef networkStyle fill:#f57c00,stroke:#e65100,stroke-width:3px,color:#fff\r\n\r\n    subgraph Host["Host Machine"]\r\n        subgraph Network["tapwork-network"]\r\n            API[API Container<br/>Port 8000]\r\n            DB[(PostgreSQL Container<br/>Port 5432)]\r\n            SMTP[Mailhog Container<br/>Port 1025/8025]\r\n            Scanner[Scanner App<br/>Port 3000]\r\n        end\r\n        \r\n        subgraph Volumes["Persistent Volumes"]\r\n            DBVol[Database Volume]\r\n            LogVol[Logs Volume]\r\n        end\r\n    end\r\n\r\n    Users[Users] --\x3e|HTTP:3000| Scanner\r\n    Scanner --\x3e|HTTP:8000| API\r\n    API --\x3e|SQL| DB\r\n    API --\x3e|SMTP| SMTP\r\n    DB -.->|Persist| DBVol\r\n    API -.->|Logs| LogVol\r\n\r\n    class API,Scanner,SMTP containerStyle\r\n    class DB containerStyle\r\n    class DBVol,LogVol volumeStyle\r\n    class Network networkStyle'}),"\n",(0,t.jsx)(r.h3,{id:"docker-compose-configuration",children:"Docker Compose Configuration"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'version: \'3.8\'\r\n\r\nservices:\r\n  # PostgreSQL Database\r\n  postgres:\r\n    image: postgres:15-alpine\r\n    container_name: tapwork-db\r\n    environment:\r\n      POSTGRES_DB: tapwork\r\n      POSTGRES_USER: tapwork_user\r\n      POSTGRES_PASSWORD: ${DB_PASSWORD}\r\n    ports:\r\n      - "5432:5432"\r\n    volumes:\r\n      - postgres_data:/var/lib/postgresql/data\r\n    healthcheck:\r\n      test: ["CMD-SHELL", "pg_isready -U tapwork_user"]\r\n      interval: 10s\r\n      timeout: 5s\r\n      retries: 5\r\n    networks:\r\n      - tapwork-network\r\n\r\n  # FastAPI Backend\r\n  api:\r\n    build:\r\n      context: ./backend\r\n      dockerfile: Dockerfile\r\n    container_name: tapwork-api\r\n    environment:\r\n      DATABASE_URL: postgresql://tapwork_user:${DB_PASSWORD}@postgres:5432/tapwork\r\n      JWT_SECRET: ${JWT_SECRET}\r\n      SMTP_HOST: mailhog\r\n      SMTP_PORT: 1025\r\n    ports:\r\n      - "8000:8000"\r\n    depends_on:\r\n      postgres:\r\n        condition: service_healthy\r\n    volumes:\r\n      - ./backend:/app\r\n      - api_logs:/app/logs\r\n    networks:\r\n      - tapwork-network\r\n    command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload\r\n\r\n  # Mailhog (Email Testing)\r\n  mailhog:\r\n    image: mailhog/mailhog:latest\r\n    container_name: tapwork-smtp\r\n    ports:\r\n      - "1025:1025"  # SMTP\r\n      - "8025:8025"  # Web UI\r\n    networks:\r\n      - tapwork-network\r\n\r\n  # Scanner Web App\r\n  scanner:\r\n    build:\r\n      context: ./frontend\r\n      dockerfile: Dockerfile\r\n    container_name: tapwork-scanner\r\n    ports:\r\n      - "3000:3000"\r\n    environment:\r\n      REACT_APP_API_URL: http://localhost:8000\r\n    volumes:\r\n      - ./frontend:/app\r\n      - /app/node_modules\r\n    networks:\r\n      - tapwork-network\r\n    command: npm start\r\n\r\nvolumes:\r\n  postgres_data:\r\n  api_logs:\r\n\r\nnetworks:\r\n  tapwork-network:\r\n    driver: bridge\n'})}),"\n",(0,t.jsx)(r.h3,{id:"container-details",children:"Container Details"}),"\n",(0,t.jsx)(r.h4,{id:"api-container",children:"API Container"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Base Image"}),": ",(0,t.jsx)(r.code,{children:"python:3.11-slim"}),"\r\n",(0,t.jsx)(r.strong,{children:"Exposed Ports"}),": 8000\r\n",(0,t.jsx)(r.strong,{children:"Environment Variables"}),":"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"DATABASE_URL"}),": PostgreSQL connection string"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"JWT_SECRET"}),": Secret key for JWT signing"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"SMTP_HOST"}),": SMTP server hostname"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"SMTP_PORT"}),": SMTP server port"]}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Health Check"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-dockerfile",children:"HEALTHCHECK --interval=30s --timeout=3s --start-period=40s --retries=3 \\\r\n  CMD curl -f http://localhost:8000/health || exit 1\n"})}),"\n",(0,t.jsx)(r.h4,{id:"postgresql-container",children:"PostgreSQL Container"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Base Image"}),": ",(0,t.jsx)(r.code,{children:"postgres:15-alpine"}),"\r\n",(0,t.jsx)(r.strong,{children:"Exposed Ports"}),": 5432\r\n",(0,t.jsx)(r.strong,{children:"Persistent Volume"}),": ",(0,t.jsx)(r.code,{children:"/var/lib/postgresql/data"}),"\r\n",(0,t.jsx)(r.strong,{children:"Initialization"}),": Runs migration scripts on first start"]}),"\n",(0,t.jsx)(r.h4,{id:"mailhog-container",children:"Mailhog Container"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Base Image"}),": ",(0,t.jsx)(r.code,{children:"mailhog/mailhog:latest"}),"\r\n",(0,t.jsx)(r.strong,{children:"Exposed Ports"}),":"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"1025 (SMTP)"}),"\n",(0,t.jsxs)(r.li,{children:["8025 (Web UI for viewing emails)\r\n",(0,t.jsx)(r.strong,{children:"Purpose"}),": Development email testing"]}),"\n"]}),"\n",(0,t.jsx)(r.h4,{id:"scanner-container",children:"Scanner Container"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"Base Image"}),": ",(0,t.jsx)(r.code,{children:"node:18-alpine"}),"\r\n",(0,t.jsx)(r.strong,{children:"Exposed Ports"}),": 3000\r\n",(0,t.jsx)(r.strong,{children:"Build Process"}),":"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Install dependencies"}),"\n",(0,t.jsx)(r.li,{children:"Start development server"}),"\n",(0,t.jsx)(r.li,{children:"Hot reload enabled"}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"local-development-setup",children:"Local Development Setup"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# Clone repository\r\ngit clone https://github.com/your-org/tapwork.git\r\ncd tapwork\r\n\r\n# Create environment file\r\ncp .env.example .env\r\n\r\n# Edit .env with your values\r\n# DB_PASSWORD=secure_password\r\n# JWT_SECRET=your_jwt_secret\r\n\r\n# Start all services\r\ndocker-compose up -d\r\n\r\n# View logs\r\ndocker-compose logs -f\r\n\r\n# Run database migrations\r\ndocker-compose exec api alembic upgrade head\r\n\r\n# Stop all services\r\ndocker-compose down\r\n\r\n# Stop and remove volumes\r\ndocker-compose down -v\n"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"kubernetes-deployment",children:"Kubernetes Deployment"}),"\n",(0,t.jsx)(r.h3,{id:"architecture-diagram-1",children:"Architecture Diagram"}),"\n",(0,t.jsx)(r.mermaid,{value:'flowchart TB\r\n    %% Styling for dark/light mode\r\n    classDef ingressStyle fill:#0288d1,stroke:#01579b,stroke-width:3px,color:#fff\r\n    classDef serviceStyle fill:#f57c00,stroke:#e65100,stroke-width:3px,color:#fff\r\n    classDef podStyle fill:#7b1fa2,stroke:#4a148c,stroke-width:3px,color:#fff\r\n    classDef storageStyle fill:#388e3c,stroke:#1b5e20,stroke-width:3px,color:#fff\r\n    classDef optionalStyle fill:#c2185b,stroke:#880e4f,stroke-width:3px,stroke-dasharray:5 5,color:#fff\r\n\r\n    subgraph K8s["Kubernetes Cluster"]\r\n        Ingress[Ingress Controller<br/>NGINX]\r\n        \r\n        subgraph Services["Services"]\r\n            APISvc[API Service]\r\n            DBSvc[DB Service]\r\n            SMTPSvc[SMTP Service]\r\n            ScanSvc[Scanner Service]\r\n        end\r\n        \r\n        subgraph Deployments["Deployments/Pods"]\r\n            API1[API Pod 1]\r\n            API2[API Pod 2]\r\n            API3[API Pod n]\r\n            SMTP[SMTP Pod]\r\n            Scan[Scanner Pod]\r\n            BIO[Biometric Pod]\r\n        end\r\n        \r\n        subgraph StatefulSet["StatefulSet"]\r\n            DB[PostgreSQL Pod]\r\n        end\r\n        \r\n        subgraph Storage["Persistent Storage"]\r\n            PVC[(PersistentVolumeClaim)]\r\n            PV[(PersistentVolume)]\r\n        end\r\n    end\r\n    \r\n    Users[Users] --\x3e|HTTPS| Ingress\r\n    Ingress --\x3e|Route| APISvc\r\n    Ingress --\x3e|Route| ScanSvc\r\n    APISvc --\x3e|Load Balance| API1\r\n    APISvc --\x3e|Load Balance| API2\r\n    APISvc --\x3e|Load Balance| API3\r\n    API1 --\x3e|SQL| DBSvc\r\n    API2 --\x3e|SQL| DBSvc\r\n    API3 --\x3e|SQL| DBSvc\r\n    DBSvc --\x3e DB\r\n    API1 --\x3e|Email| SMTPSvc\r\n    SMTPSvc --\x3e SMTP\r\n    API1 -.->|Optional| BIO\r\n    API2 -.->|Optional| BIO\r\n    DB --\x3e|Store| PVC\r\n    PVC --\x3e|Mount| PV\r\n\r\n    class Ingress ingressStyle\r\n    class APISvc,DBSvc,SMTPSvc,ScanSvc serviceStyle\r\n    class API1,API2,API3,SMTP,Scan,DB podStyle\r\n    class PVC,PV storageStyle\r\n    class BIO optionalStyle'}),"\n",(0,t.jsx)(r.h3,{id:"kubernetes-resources",children:"Kubernetes Resources"}),"\n",(0,t.jsx)(r.h4,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: tapwork\r\n  labels:\r\n    name: tapwork\n"})}),"\n",(0,t.jsx)(r.h4,{id:"configmap",children:"ConfigMap"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: tapwork-config\r\n  namespace: tapwork\r\ndata:\r\n  DATABASE_HOST: postgres-service\r\n  DATABASE_PORT: "5432"\r\n  DATABASE_NAME: tapwork\r\n  SMTP_HOST: smtp-service\r\n  SMTP_PORT: "1025"\r\n  API_HOST: "0.0.0.0"\r\n  API_PORT: "8000"\n'})}),"\n",(0,t.jsx)(r.h4,{id:"secrets",children:"Secrets"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Secret\r\nmetadata:\r\n  name: tapwork-secrets\r\n  namespace: tapwork\r\ntype: Opaque\r\ndata:\r\n  # Base64 encoded values\r\n  db-password: <base64_encoded_password>\r\n  jwt-secret: <base64_encoded_secret>\r\n  smtp-password: <base64_encoded_password>\n"})}),"\n",(0,t.jsx)(r.h4,{id:"api-deployment",children:"API Deployment"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: tapwork-api\r\n  namespace: tapwork\r\nspec:\r\n  replicas: 3\r\n  selector:\r\n    matchLabels:\r\n      app: tapwork-api\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: tapwork-api\r\n    spec:\r\n      containers:\r\n      - name: api\r\n        image: tapwork/api:latest\r\n        ports:\r\n        - containerPort: 8000\r\n        env:\r\n        - name: DATABASE_URL\r\n          value: "postgresql://$(DB_USER):$(DB_PASSWORD)@postgres-service:5432/tapwork"\r\n        - name: DB_PASSWORD\r\n          valueFrom:\r\n            secretKeyRef:\r\n              name: tapwork-secrets\r\n              key: db-password\r\n        - name: JWT_SECRET\r\n          valueFrom:\r\n            secretKeyRef:\r\n              name: tapwork-secrets\r\n              key: jwt-secret\r\n        envFrom:\r\n        - configMapRef:\r\n            name: tapwork-config\r\n        resources:\r\n          requests:\r\n            memory: "256Mi"\r\n            cpu: "250m"\r\n          limits:\r\n            memory: "512Mi"\r\n            cpu: "500m"\r\n        livenessProbe:\r\n          httpGet:\r\n            path: /health\r\n            port: 8000\r\n          initialDelaySeconds: 30\r\n          periodSeconds: 10\r\n        readinessProbe:\r\n          httpGet:\r\n            path: /health\r\n            port: 8000\r\n          initialDelaySeconds: 5\r\n          periodSeconds: 5\n'})}),"\n",(0,t.jsx)(r.h4,{id:"postgresql-statefulset",children:"PostgreSQL StatefulSet"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'apiVersion: apps/v1\r\nkind: StatefulSet\r\nmetadata:\r\n  name: postgres\r\n  namespace: tapwork\r\nspec:\r\n  serviceName: postgres-service\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: postgres\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: postgres\r\n    spec:\r\n      containers:\r\n      - name: postgres\r\n        image: postgres:15-alpine\r\n        ports:\r\n        - containerPort: 5432\r\n        env:\r\n        - name: POSTGRES_DB\r\n          value: tapwork\r\n        - name: POSTGRES_USER\r\n          value: tapwork_user\r\n        - name: POSTGRES_PASSWORD\r\n          valueFrom:\r\n            secretKeyRef:\r\n              name: tapwork-secrets\r\n              key: db-password\r\n        volumeMounts:\r\n        - name: postgres-storage\r\n          mountPath: /var/lib/postgresql/data\r\n        resources:\r\n          requests:\r\n            memory: "512Mi"\r\n            cpu: "500m"\r\n          limits:\r\n            memory: "1Gi"\r\n            cpu: "1000m"\r\n  volumeClaimTemplates:\r\n  - metadata:\r\n      name: postgres-storage\r\n    spec:\r\n      accessModes: [ "ReadWriteOnce" ]\r\n      resources:\r\n        requests:\r\n          storage: 10Gi\n'})}),"\n",(0,t.jsx)(r.h4,{id:"service-definitions",children:"Service Definitions"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: tapwork-api-service\r\n  namespace: tapwork\r\nspec:\r\n  selector:\r\n    app: tapwork-api\r\n  ports:\r\n  - protocol: TCP\r\n    port: 8000\r\n    targetPort: 8000\r\n  type: ClusterIP\r\n\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: postgres-service\r\n  namespace: tapwork\r\nspec:\r\n  selector:\r\n    app: postgres\r\n  ports:\r\n  - protocol: TCP\r\n    port: 5432\r\n    targetPort: 5432\r\n  type: ClusterIP\r\n  clusterIP: None  # Headless service for StatefulSet\r\n\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: smtp-service\r\n  namespace: tapwork\r\nspec:\r\n  selector:\r\n    app: smtp\r\n  ports:\r\n  - name: smtp\r\n    protocol: TCP\r\n    port: 1025\r\n    targetPort: 1025\r\n  - name: ui\r\n    protocol: TCP\r\n    port: 8025\r\n    targetPort: 8025\r\n  type: ClusterIP\n"})}),"\n",(0,t.jsx)(r.h4,{id:"ingress",children:"Ingress"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:'apiVersion: networking.k8s.io/v1\r\nkind: Ingress\r\nmetadata:\r\n  name: tapwork-ingress\r\n  namespace: tapwork\r\n  annotations:\r\n    nginx.ingress.kubernetes.io/ssl-redirect: "true"\r\n    cert-manager.io/cluster-issuer: "letsencrypt-prod"\r\nspec:\r\n  ingressClassName: nginx\r\n  tls:\r\n  - hosts:\r\n    - api.tapwork.com\r\n    - scanner.tapwork.com\r\n    secretName: tapwork-tls\r\n  rules:\r\n  - host: api.tapwork.com\r\n    http:\r\n      paths:\r\n      - path: /\r\n        pathType: Prefix\r\n        backend:\r\n          service:\r\n            name: tapwork-api-service\r\n            port:\r\n              number: 8000\r\n  - host: scanner.tapwork.com\r\n    http:\r\n      paths:\r\n      - path: /\r\n        pathType: Prefix\r\n        backend:\r\n          service:\r\n            name: scanner-service\r\n            port:\r\n              number: 3000\n'})}),"\n",(0,t.jsx)(r.h4,{id:"horizontalpodautoscaler",children:"HorizontalPodAutoscaler"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\r\nkind: HorizontalPodAutoscaler\r\nmetadata:\r\n  name: tapwork-api-hpa\r\n  namespace: tapwork\r\nspec:\r\n  scaleTargetRef:\r\n    apiVersion: apps/v1\r\n    kind: Deployment\r\n    name: tapwork-api\r\n  minReplicas: 3\r\n  maxReplicas: 10\r\n  metrics:\r\n  - type: Resource\r\n    resource:\r\n      name: cpu\r\n      target:\r\n        type: Utilization\r\n        averageUtilization: 70\r\n  - type: Resource\r\n    resource:\r\n      name: memory\r\n      target:\r\n        type: Utilization\r\n        averageUtilization: 80\n"})}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"deployment-workflow",children:"Deployment Workflow"}),"\n",(0,t.jsx)(r.h3,{id:"production-deployment-process",children:"Production Deployment Process"}),"\n",(0,t.jsx)(r.mermaid,{value:"flowchart LR\r\n    %% Styling for dark/light mode\r\n    classDef devStyle fill:#0288d1,stroke:#01579b,stroke-width:3px,color:#fff\r\n    classDef buildStyle fill:#f57c00,stroke:#e65100,stroke-width:3px,color:#fff\r\n    classDef testStyle fill:#7b1fa2,stroke:#4a148c,stroke-width:3px,color:#fff\r\n    classDef deployStyle fill:#388e3c,stroke:#1b5e20,stroke-width:3px,color:#fff\r\n\r\n    Dev[Code Commit] --\x3e Build[Build Docker Images]\r\n    Build --\x3e Test[Run Tests]\r\n    Test --\x3e Push[Push to Registry]\r\n    Push --\x3e Deploy[Deploy to K8s]\r\n    Deploy --\x3e Verify[Health Checks]\r\n    Verify --\x3e Monitor[Monitor]\r\n\r\n    class Dev devStyle\r\n    class Build,Push buildStyle\r\n    class Test testStyle\r\n    class Deploy,Verify,Monitor deployStyle"}),"\n",(0,t.jsx)(r.h3,{id:"deployment-steps",children:"Deployment Steps"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Build Docker Images"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"docker build -t tapwork/api:v1.0.0 ./backend\r\ndocker build -t tapwork/scanner:v1.0.0 ./frontend\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Run Tests"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"docker run tapwork/api:v1.0.0 pytest\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Push to Registry"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"docker push tapwork/api:v1.0.0\r\ndocker push tapwork/scanner:v1.0.0\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Deploy to Kubernetes"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"kubectl apply -f k8s/namespace.yaml\r\nkubectl apply -f k8s/configmap.yaml\r\nkubectl apply -f k8s/secrets.yaml\r\nkubectl apply -f k8s/postgres-statefulset.yaml\r\nkubectl apply -f k8s/api-deployment.yaml\r\nkubectl apply -f k8s/services.yaml\r\nkubectl apply -f k8s/ingress.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Verify Deployment"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"kubectl get pods -n tapwork\r\nkubectl logs -f deployment/tapwork-api -n tapwork\r\nkubectl get ingress -n tapwork\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"environment-configuration",children:"Environment Configuration"}),"\n",(0,t.jsx)(r.h3,{id:"development",children:"Development"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Single instance of each service"}),"\n",(0,t.jsx)(r.li,{children:"Hot reload enabled"}),"\n",(0,t.jsx)(r.li,{children:"Debug logging"}),"\n",(0,t.jsx)(r.li,{children:"Mailhog for email testing"}),"\n",(0,t.jsx)(r.li,{children:"No TLS required"}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"staging",children:"Staging"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"2 replicas of API"}),"\n",(0,t.jsx)(r.li,{children:"Real SMTP server"}),"\n",(0,t.jsx)(r.li,{children:"Production-like data (anonymized)"}),"\n",(0,t.jsx)(r.li,{children:"TLS enabled"}),"\n",(0,t.jsx)(r.li,{children:"Performance testing"}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"production",children:"Production"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"3+ replicas of API (auto-scaling)"}),"\n",(0,t.jsx)(r.li,{children:"Managed database (RDS, Cloud SQL)"}),"\n",(0,t.jsx)(r.li,{children:"Production SMTP (SendGrid, SES)"}),"\n",(0,t.jsx)(r.li,{children:"Full monitoring and alerting"}),"\n",(0,t.jsx)(r.li,{children:"Automated backups"}),"\n",(0,t.jsx)(r.li,{children:"TLS required"}),"\n",(0,t.jsx)(r.li,{children:"Rate limiting enabled"}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"monitoring-and-logging",children:"Monitoring and Logging"}),"\n",(0,t.jsx)(r.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: ServiceMonitor\r\nmetadata:\r\n  name: tapwork-api-metrics\r\n  namespace: tapwork\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: tapwork-api\r\n  endpoints:\r\n  - port: metrics\r\n    interval: 30s\n"})}),"\n",(0,t.jsx)(r.h3,{id:"logging-stack",children:"Logging Stack"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Fluentd"}),": Log collection"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Elasticsearch"}),": Log storage"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Kibana"}),": Log visualization"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"alerts",children:"Alerts"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Pod restart alerts"}),"\n",(0,t.jsx)(r.li,{children:"High error rate alerts"}),"\n",(0,t.jsx)(r.li,{children:"Resource usage alerts"}),"\n",(0,t.jsx)(r.li,{children:"Database connection alerts"}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"backup-strategy",children:"Backup Strategy"}),"\n",(0,t.jsx)(r.h3,{id:"database-backups",children:"Database Backups"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"# Daily automated backup\r\nkubectl exec postgres-0 -n tapwork -- \\\r\n  pg_dump -U tapwork_user tapwork > backup-$(date +%Y%m%d).sql\r\n\r\n# Upload to cloud storage\r\naws s3 cp backup-$(date +%Y%m%d).sql s3://tapwork-backups/\n"})}),"\n",(0,t.jsx)(r.h3,{id:"configuration-backups",children:"Configuration Backups"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Git repository for all K8s manifests"}),"\n",(0,t.jsx)(r.li,{children:"Secrets stored in secure vault"}),"\n",(0,t.jsx)(r.li,{children:"Regular export of ConfigMaps"}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.admonition,{title:"Deployment Best Practices",type:"tip",children:(0,t.jsx)(r.p,{children:"Always test deployments in staging before production. Use blue-green deployments or canary releases for zero-downtime updates. Maintain comprehensive rollback procedures."})})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var s=n(6540);const t={},a=s.createContext(t);function o(e){const r=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);